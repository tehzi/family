(function(){var t,e,o,i,n,r,s=function(t,e){function o(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},l={}.hasOwnProperty,a=[].slice,h=function(t,e){return function(){return t.apply(e,arguments)}};t=function(t){function o(){var t;t=1<=arguments.length?a.call(arguments,0):[],this.model=e,o.__super__.constructor.apply(this,t)}return s(o,t),o.prototype.localStorage=new Backbone.LocalStorage("e39b168e"),o.prototype.model=null,o}(Backbone.Collection),e=function(t){function e(){var t;t=1<=arguments.length?a.call(arguments,0):[],e.__super__.constructor.apply(this,t)}return s(e,t),e.prototype.defaults={icon:null,name:null,bookmark:null,date:new Date},e.prototype.idAttribute="bookmark",e}(Backbone.Model),window.tools=_.extend(window.tools||{},{BookmarksView:null}),window.tools.BookmarksView=function(i){function n(){var e;e=1<=arguments.length?a.call(arguments,0):[],this._append=h(this._append,this),this._displayToggle=h(this._displayToggle,this),this.render=h(this.render,this),this.close=h(this.close,this),this.open=h(this.open,this),this.hide=h(this.hide,this),this.show=h(this.show,this),this.find=h(this.find,this),this.remove=h(this.remove,this),this.add=h(this.add,this),this.events=h(this.events,this),this.initialize=h(this.initialize,this),c=_.template('<div class="bookmark-view">\n    <div class="bookmark_view-widget">\n        <div class="fa fa-star left"></div>\n        <div class="bookmark_view-count left">{{{count}}}</div>\n    </div>\n    <div class="bookmark_view-box">\n        {[ _.each(bookmarks, function(bookmark){ ]}\n            {{bookmark}}\n        {[ }); ]}\n    </div>\n</div>'),this.bookmarks=[],this.collection=new t,_.extend(this,e[0]),n.__super__.constructor.apply(this,e)}var r,l,c;return s(n,i),l=null,c=null,r=0,n.prototype.collection=null,n.prototype.parent=null,n.prototype.bookmarks=[],n.prototype.animationTime=300,n.prototype.isOpen=!1,n.prototype.initialize=function(){return this.collection.fetch(),this.render(),this.collection.length&&this.show(),this.collection.on("add",this.render),this.collection.on("remove",this.render),$(window).scroll(function(t){return function(){return null!=t.$el?t.$el.css("top",parseInt($(window).scrollTop())+r):void 0}}(this))},n.prototype.events=function(){return{"click .bookmark_view-count":"_displayToggle"}},n.prototype.add=function(t,o,i){var n;return n=new e({icon:t,name:o,bookmark:i}),this.collection.add(n),n.save().done(function(t){return function(){return t._append(n)}}(this))},n.prototype.remove=function(t){var e;return e=this.find(t),null!=e?e.destroy():void 0},n.prototype.find=function(t){return null!=this.collection?this.collection.findWhere({bookmark:t}):void 0},n.prototype.show=function(){return null!=this.parent?$.when(this.$el.css({opacity:0}).appendTo(this.parent.$el)).then(function(t){return function(){return r?void 0:r=parseInt(t.$el.css("top"))}}(this)).done(function(t){return function(){return t.$el.animate({opacity:1},t.animationTime)}}(this)):void 0},n.prototype.hide=function(){return null!=this.parent?this.$el.animate({opacity:0},this.animationTime,function(t){return function(){return t.close(),t.$el.detach()}}(this)):void 0},n.prototype.open=function(){return null!=this.$el?(this.$el.find(".bookmark_view-box").show(),this.isOpen=!0):void 0},n.prototype.close=function(){return null!=this.$el?(this.$el.find(".bookmark_view-box").hide(),this.isOpen=!1):void 0},n.prototype.render=function(){return this.$el.hasClass("bookmark-view")||(this.$el=$(c({count:this.collection.length,bookmarks:[]})),this.el=this.$el.get(0),this.collection.each(this._append)),this.$el.find(".bookmark_view-count").html(this.collection.length),1===this.collection.length&&this.show(),0===this.collection.length?this.hide():void 0},n.prototype._displayToggle=function(){return this.isOpen?this.close():this.open()},n.prototype._append=function(t){return this.bookmarks.push(new o({model:t})),this.$el.find(".bookmark_view-box").append(_.last(this.bookmarks).render())},n.getBookmarks=function(){var t;return t=1<=arguments.length?a.call(arguments,0):[],null==l?l=function(t,e,o){o.prototype=t.prototype;var i=new o,n=t.apply(i,e);return Object(n)===n?n:i}(this,t,function(){}):l},n}(Backbone.View),$(function(){return null===main.bookmark?main.bookmark=tools.BookmarksView.getBookmarks({parent:main.view}):void 0}),o=function(t){function e(){var t;t=1<=arguments.length?a.call(arguments,0):[],this.render=h(this.render,this),this.remove=h(this.remove,this),this.events=h(this.events,this),this.initialize=h(this.initialize,this),o=_.template('<div class="bookmark_view-item">\n    <div class="left bookmark_view_image-wrapper">\n        <a href="{{{href}}}"><img src="{{src}}" alt="{{alt}}"></a>\n    </div>\n    <div class="bookmark_view-wrapper">\n        <div class="bookmark_view-name"><a href="{{{href}}}">{{{name}}}</a></div>\n        <div class="bookmark_view-date">{{{date}}}</div>\n    </div>\n    <a href="javascript:void(0)" class="bookmark_view-remove fa fa-times"></a>\n</div>'),e.__super__.constructor.apply(this,t)}var o;return s(e,t),o=null,e.prototype.initialize=function(){return this.model.on("remove",this.remove),this.render()},e.prototype.events=function(){return{"click .bookmark_view-remove":"remove"}},e.prototype.remove=function(){return null!=this.model&&this.model.destroy(),this.$el.remove()},e.prototype.render=function(){var t;return this.$el.hasClass("bookmark_view-item")||(t=new Date(this.model.get("date")),t=("0"+t.getDate()).slice(-2)+"."+("0"+(t.getMonth()+1)).slice(-2)+("."+t.getFullYear()),this.$el=$(o({src:this.model.get("icon"),alt:this.model.get("name"),name:this.model.get("name"),href:this.model.get("bookmark"),date:t})),this.el=this.$el.get(0)),this.$el},e}(Backbone.View),window.tools=_.extend(window.tools||{},{LoadingBox:null}),window.tools.LoadingBox=function(){function t(t){this.selector=t,this.setAlt=h(this.setAlt,this),this.setImage=h(this.setImage,this),i=$(this.selector),this._template=_.template(n)}var e,o,i,n;return t.prototype.selector="",t.prototype._template=null,o=null,e="",i=null,n="<img src='{{src}}' alt=''>",t.prototype.setImage=function(t){return null!=i&&i.length?(o=$(this._template({src:t})),o.on("load",function(t){return function(){return $(t).trigger("end"),e?t.setAlt(e):void 0}}(this)),i.append(o),$(this).trigger("start")):void 0},t.prototype.getImage=function(){return o},t.prototype.setAlt=function(t){return null===o?e=t:o.attr("alt",t)},t.prototype.reset=function(){return o=null,e="",this._template=_.template(n)},t}(),i=function(t){function e(t,o){null==t&&(t=[]),null==o&&(o={}),this.model=n,e.__super__.constructor.call(this,t,o)}return s(e,t),e.prototype.localStorage=new Backbone.LocalStorage("bda2a6d8"),e.prototype.findByMark=function(t){return this.indexBy(t,"mark")},e}(Backbone.Collection),n=function(t){function e(){var t;t=1<=arguments.length?a.call(arguments,0):[],e.__super__.constructor.apply(this,t)}return s(e,t),e.prototype.idAttribute="mark",e.prototype.defaults={mark:!1,title:"",tip:"",autoshow:!0},e}(Backbone.Model),window.tools=_.extend(window.tools||{},{TooltipsView:null}),window.tools.TooltipsView=function(t){function e(t){this.show=h(this.show,this),this.initialize=h(this.initialize,this),this.collection=new i,this.tooltips=[],e.__super__.constructor.call(this,t)}var o,l;return s(e,t),l=null,o=null,e.collection=null,e.prototype.tooltips=[],e.prototype.initialize=function(){return this.collection.fetch(),$('[data-toggle="tooltip-view"]').each(function(t){return function(e,o){var i,s,l,a;return i=$(o),s=i.data("mark"),l=t.collection.findWhere({mark:s}),null==l&&(a={mark:s,title:i.data("title"),tip:i.attr("title"),autoshow:i.data("autoshow")},l=new n(_.extend({},n.prototype.defaults,a)),t.collection.add(l),l.save()),t.tooltips.push(new r({model:l,parent:o}))}}(this))},e.prototype.show=function(){return _.each(this.tooltips,function(){return function(t){return t.show()}}(this))},e.getTooltip=function(){return null===l?l=new e:l},e.error=function(t,e){var i;return null!=o&&o.remove(),i=_.template('<div class="tooltip_view-error">\n    <div class="tooltip_view_error-title">{{{title}}}</div>\n    <div class="tooltip_view_error-content">{{{error}}}</div>\n    <a href="javascript:void(0)" class="tooltip_view-remove fa fa-times"></a>\n</div>'),o=$(i({title:t,error:e})),o.css({opacity:0}).appendTo("body").animate({opacity:1}).find(".tooltip_view-remove").on("click",this.errorClose)},e.errorClose=function(){return null!=o?o.remove():void 0},e}(Backbone.View),$(function(){return main.tooltip=tools.TooltipsView.getTooltip()}),r=function(t){function e(){var t;t=1<=arguments.length?a.call(arguments,0):[],this._close=h(this._close,this),this.close=h(this.close,this),this.render=h(this.render,this),this.show=h(this.show,this),this.autoshow=h(this.autoshow,this),this.events=h(this.events,this),this.initialize=h(this.initialize,this),o=_.template('<div class="tooltip-view">\n    <div class="tooltip_view-close fa fa-times"></div>\n    <div class="tooltip_view-title">{{{title}}}</div>\n    <div class="tooltip_view-content">{{{content}}}</div>\n</div>'),e.__super__.constructor.apply(this,t),_.extend(this,t[0]),null!=this.parent&&(this.$parent=$(this.parent))}var o;return s(e,t),o=null,e.prototype.parent=null,e.prototype.$parent=null,e.prototype.timeToClose=1e4,e.prototype.initialize=function(){return this.el=o({title:this.model.get("title"),content:this.model.get("tip")}),this.$el=$(this.el)},e.prototype.events=function(){return{"click .tooltip_view-close":"close"}},e.prototype.autoshow=function(){return this.model.get("autoshow")},e.prototype.show=function(){return this.autoshow()?this.render():void 0},e.prototype.render=function(){var t,e,o,i;return i=[],e=i[0],o=i[1],t=i[2],$.when(this.$el.css({opacity:0}).appendTo("body")).then(function(i){return function(){return e=i.$parent.offset(),o=e.top+i.$parent.height()+parseInt(i.$el.css("margin-top")),t=e.left+parseInt(i.$el.css("margin-left"))}}(this)).done(function(e){return function(){return e.$el.css({top:o,left:t}).animate({opacity:1},1300,function(){return setTimeout(e._close,e.timeToClose)})}}(this))},e.prototype.close=function(){return this.model.set("autoshow",!1),this.model.save(),this._close()},e.prototype._close=function(){return this.$el.animate({opacity:0},300)},e}(Backbone.View)}).call(this);